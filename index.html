<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CBS Web HaritasÄ±</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <link rel="stylesheet" href="./style.css"/>
</head>
<body>

  <div id="authScreen" class="auth-screen">
    <div class="auth-cover" style="background-image:url('./data/login-bg.png')"></div>

    <div class="auth-card">
      <div class="auth-brand">
        <div class="brand-dot"></div>
        <div>
          <div class="auth-title">CBS Web Map</div>
          <div class="auth-sub">GiriÅŸ yap</div>
        </div>
      </div>

      <form id="loginForm" class="auth-form">
        <label class="auth-label">E-posta</label>
        <input id="loginEmail" class="auth-input" type="email" placeholder="ornek@mail.com" required />

        <label class="auth-label">Åifre</label>
        <input id="loginPass" class="auth-input" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />

        <button class="btn primary auth-btn" type="submit">GiriÅŸ Yap</button>

        <div class="auth-mini">
          Sorun mu var?
          <button type="button" class="linkbtn" id="forgotBtn">Åifre sÄ±fÄ±rla</button>
        </div>
      </form>

      <div id="authMsg" class="auth-msg">HazÄ±r</div>
    </div>
  </div>

  <div class="app" id="appRoot" style="display:none;">
    
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-dot"></div>
        <div>
          <div class="brand-title">CBS Web Map</div>
          <div class="brand-sub" id="userLine">â€”</div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="layers">Katmanlar</button>
        <button class="tab" data-tab="basemaps">AltlÄ±k</button>
        <button class="tab" data-tab="import">Ä°Ã§e Aktar</button>
      </div>

      <section class="panel active" id="tab-layers">
        <div class="panel-title">Katmanlar</div>

        <div class="group-create">
          <input id="newGroupName" type="text" placeholder="Yeni grup adÄ±"/>
          <button id="addGroupBtn" class="btn primary">Grup Ekle</button>
        </div>

        <div id="groupList" class="group-list"></div>

        <div class="hint">
          KatmanlarÄ± aÃ§/kapatabilir, gruplarÄ± yÃ¶netebilir, tek menÃ¼den stil/Ã¶znitelik tablosu gibi iÅŸlemleri seÃ§ebilirsin.
        </div>
      </section>

      <section class="panel" id="tab-basemaps">
        <div class="panel-title">AltlÄ±k Harita</div>
        <div class="radio-list">
          <label><input type="radio" name="basemap" value="osm" checked> OpenStreetMap</label>
          <label><input type="radio" name="basemap" value="cartoLight"> Carto Light</label>
          <label><input type="radio" name="basemap" value="esriSat"> Esri Satellite</label>
        </div>
        <div class="hint">AltlÄ±k haritayÄ± buradan deÄŸiÅŸtir.</div>
      </section>

      <section class="panel" id="tab-import">
        <div class="panel-title">Veri Ä°Ã§e Aktar</div>

        <div class="box">
          <div class="box-title">GeoJSON</div>
          <input type="file" id="geojsonFile" accept=".geojson,.json"/>
          <div class="mini">.geojson / .json</div>
        </div>

        <div class="box">
          <div class="box-title">Shapefile (ZIP)</div>
          <input type="file" id="shpZipFile" accept=".zip"/>
          <div class="mini">.zip iÃ§inde .shp .shx .dbf .prj olmalÄ±</div>
        </div>

        <div class="hint">
          Ä°Ã§e aktardÄ±ÄŸÄ±n katmanlar â€œKatmanlarâ€ listesine gelir.
          <br/>KalÄ±cÄ± katmanlar <b>data/layers.json</b> ile yÃ¶netilir.
        </div>
      </section>

      <div class="sidebar-foot">
        <button id="logoutBtn" class="btn">Ã‡Ä±kÄ±ÅŸ Yap</button>
      </div>
    </aside>

    <div id="sidebarToggle" class="sidebar-toggle" title="Paneli AÃ§/Kapat">â—€</div>

    <main class="mapwrap">
      <div id="map"></div>

      <div class="toolbar">
        <button id="zoomToAll" class="toolbtn">TÃ¼m Katmanlara Git</button>
        <button id="clearImports" class="toolbtn danger">Ä°Ã§e AktarÄ±lanlarÄ± Temizle</button>
        <button id="toolsBtn" class="iconbtn" title="AraÃ§lar">ğŸ§°</button>
      </div>

      <div id="toolbox" class="toolbox hidden">
        <div class="toolbox-head">
          <div class="toolbox-title">AraÃ§lar</div>
          <button id="toolboxClose" class="xbtn" title="Kapat">Ã—</button>
        </div>
        <div class="toolbox-body" id="toolboxBody"></div>
        <div class="toolbox-foot">
          <div class="toolbox-status" id="toolStatus">HazÄ±r</div>
        </div>
      </div>

      <div id="styleModal" class="modal hidden">
        <div class="modal-card">
          <div class="modal-head">
            <div>
              <div class="modal-title" id="styleTitle">Stil</div>
              <div class="modal-sub">Ã‡izgi / dolgu / Ã§izgi tipi</div>
            </div>
            <button id="styleClose" class="xbtn" title="Kapat">Ã—</button>
          </div>
          
          <div class="modal-body">
            <div class="formrow">
              <div class="label">DÄ±ÅŸ Ã§izgi rengi</div>
              <div class="row2">
                <input id="lineColor" type="color" />
              </div>
            </div>

            <div class="formrow">
              <div class="label">Dolgu rengi</div>
              <div class="row2">
                <input id="fillColor" type="color" />
              </div>
            </div>

            <div class="formrow">
              <div class="label">Dolgu saydamlÄ±ÄŸÄ±</div>
              <div class="row2">
                <input id="fillOpacity" type="range" min="0" max="1" step="0.05"/>
                <div class="val" id="fillOpacityVal">0.20</div>
              </div>
            </div>

            <div class="formrow">
              <div class="label">Ã‡izgi kalÄ±nlÄ±ÄŸÄ±</div>
              <div class="row2">
                <input id="lineWeight" type="range" min="1" max="10" step="1"/>
                <div class="val" id="lineWeightVal">2</div>
              </div>
            </div>

            <div class="formrow">
              <div class="label">Ã‡izgi tipi</div>
              <div class="row2">
                <select id="lineDash" class="tb-select">
                  <option value="solid">Solid</option>
                  <option value="dash">Dash</option>
                  <option value="dot">Dot</option>
                  <option value="dashdot">Dash-dot</option>
                </select>
              </div>
            </div>
          </div>

          <div class="modal-foot">
            <button id="styleReset" class="btn ghost">VarsayÄ±lana DÃ¶n</button>
            <button id="styleApply" class="btn primary">Uygula</button>
          </div>
        </div>
      </div>

      <div id="addFieldModal" class="modal hidden">
        <div class="modal-card">
          <div class="modal-head">
            <div>
              <div class="modal-title">Yeni Kolon Ekle</div>
              <div class="modal-sub">Tabloya yeni veri alanÄ± ekle</div>
            </div>
            <button id="addFieldClose" class="xbtn" title="Kapat">Ã—</button>
          </div>
      
          <div class="modal-body">
            <div class="formrow">
              <div class="label">Kolon AdÄ±</div>
              <div class="row2" style="width: 100%;">
                <input id="newFieldName" class="tb-input" type="text" placeholder="Ã¶rn: nufus_yogunlugu" />
              </div>
            </div>
      
            <div class="formrow">
              <div class="label">Veri Tipi</div>
              <div class="row2" style="width: 100%;">
                <select id="newFieldType" class="tb-select">
                  <option value="string">Metin (String)</option>
                  <option value="int">Tam SayÄ± (Integer)</option>
                  <option value="float">OndalÄ±klÄ± SayÄ± (Float)</option>
                  <option value="bool">MantÄ±ksal (Boolean)</option>
                </select>
              </div>
            </div>
      
            <div class="formrow">
              <div class="label">VarsayÄ±lan DeÄŸer</div>
              <div class="row2" style="width: 100%;">
                <input id="newFieldDef" class="tb-input" type="text" placeholder="BoÅŸ bÄ±rakÄ±lÄ±rsa varsayÄ±lan atanÄ±r" />
              </div>
            </div>
            
            <div class="hint" style="margin-top:0;">
              Not: Kolon adÄ±ndaki boÅŸluklar otomatik olarak '_' ile deÄŸiÅŸtirilir.
            </div>
          </div>
      
          <div class="modal-foot">
            <button id="createFieldConfirm" class="btn primary">Kolon OluÅŸtur</button>
          </div>
        </div>
      </div>

      <div id="attrDrawer" class="attr-drawer hidden">
        <div class="attr-head">
          <div class="attr-left">
            <div class="attr-title">Ã–znitelik Tablosu</div>
            <div class="attr-sub" id="attrSub">â€”</div>
          </div>

          <div class="attr-right">
            <button id="attrClose" class="xbtn" title="Kapat">Ã—</button>
          </div>
        </div>

        <div class="attr-toolbar">
          <button id="attrGoLayers" class="btn ghost" title="Katmanlar sekmesine git">Katmanlar</button>

          <label class="attr-label">
            Katman:
            <select id="attrLayerSelect" class="attr-select"></select>
          </label>

          <div class="attr-spacer"></div>

          <div class="filter-group">
            <select id="attrFilterCol" class="attr-select" style="min-width:120px;">
              <option value="">(Kolon SeÃ§)</option>
            </select>
        
            <select id="attrFilterOp" class="attr-select" style="width:90px; min-width:90px;">
              <option value="contains">Ä°Ã§erir</option>
              <option value="eq">EÅŸittir (=)</option>
              <option value="gt">BÃ¼yÃ¼ktÃ¼r (&gt;)</option>
              <option value="lt">KÃ¼Ã§Ã¼ktÃ¼r (&lt;)</option>
              <option value="gte">BÃ¼yÃ¼k EÅŸit (&gt;=)</option>
              <option value="lte">KÃ¼Ã§Ã¼k EÅŸit (&lt;=)</option>
            </select>
        
            <input id="attrFilterVal" class="attr-input" placeholder="DeÄŸer..." style="min-width:100px; width:120px;" />
        
            <button id="attrApplyFilter" class="btn primary">Filtrele</button>
            <button id="attrClearFilter" class="btn ghost">Temizle</button>
          </div>
          <div class="attr-spacer"></div>

          <button id="attrAddField" class="btn ghost">Yeni Kolon</button>
          <button id="attrExportCsv" class="btn primary">Excel (CSV) Ä°ndir</button>
        </div>
        <div class="attr-tablewrap">
          <table class="attr-table" id="attrTable"></table>
        </div>

        <div class="attr-foot">
          <div class="attr-foot-left" id="attrCount">0 kayÄ±t</div>
          <div class="attr-foot-right">
            <button id="attrZoomSel" class="btn ghost">SeÃ§ilene Git</button>
            <button id="attrClearSel" class="btn ghost">SeÃ§imi Temizle</button>
          </div>
        </div>
      </div>

      <div id="legendBox" class="legend-box hidden">
        <div class="legend-head">
          <span class="legend-title">Lejant</span>
          <button id="legendToggle" class="xbtn small" title="KÃ¼Ã§Ã¼lt">_</button>
        </div>
        <div id="legendContent" class="legend-content"></div>
      </div>

      <div class="statusbar" id="statusbar">HazÄ±r</div>
      <div id="coordBox" class="coord-box">
        0.00000, 0.00000
      </div>

      <div id="contextMenu" class="ctx-menu hidden">
        <div class="ctx-item" id="ctxZoom">ğŸ” Buraya Odaklan</div>
        <div class="ctx-item" id="ctxCopy">ğŸ“‹ KoordinatÄ± Kopyala</div>
        <div class="ctx-item" id="ctxGoogle">ğŸŒ Google Maps'te AÃ§</div>
        <div class="ctx-sep"></div>
        <div class="ctx-item" id="ctxCenter">ğŸ“ Merkezi BurasÄ± Yap</div>
      </div>
    </main>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.11.0/proj4.min.js"></script>
  <script type="module" src="./app.js"></script>

</body>
</html>
